type: charm

parts:
  charm:
    after: [update-certificates]
    charm-python-packages:
      # See https://github.com/canonical/charmcraft/issues/551
      - setuptools
    build-packages:
      - git

  update-certificates:
    plugin: nil
    # See https://github.com/canonical/charmcraft/issues/658
    override-build: |
      apt update -qqq
      apt install -qy ca-certificates
      update-ca-certificates
bases:
  - build-on:
    - name: ubuntu
      channel: "20.04"
      architectures: [amd64]
    run-on:
    - name: ubuntu
      channel: "22.04"
      architectures: [amd64, s390x, ppc64el, arm64]
    run-on:
    - name: ubuntu
      channel: "20.04"
      architectures: [amd64, s390x, ppc64el, arm64]

